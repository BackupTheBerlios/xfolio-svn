<?xml version="1.0"?><!--for action taglib  xmlns:action="http://apache.org/cocoon/action/1.0"--><xsp:page language="java" xmlns:xsp="http://apache.org/xsp" >	<xsp:structure>		<xsp:include>org.apache.cocoon.environment.Session</xsp:include>		<xsp:include>java.util.zip.*</xsp:include>		<xsp:include>java.util.*</xsp:include>		<xsp:include>java.io.*</xsp:include>		<xsp:include>org.apache.avalon.framework.context.ContextException</xsp:include>		<xsp:include>org.apache.cocoon.environment.Redirector</xsp:include>		<xsp:include>org.apache.cocoon.acting.ServerPagesAction</xsp:include>		<xsp:include>java.util.Map</xsp:include>	</xsp:structure>	<!--	This xsp don't use cocoon taglib action.xsl 	(less easier than a simple java line)		When an entry in a zip is requested, it is deflated as a file		workaround of jar:protocol which seems not easy to refresh-->	<xsp:logic>      private Redirector actionRedirector;      private Map actionResultMap;		</xsp:logic>	<view>		<xsp:logic><![CDATA[       this.actionRedirector = (Redirector)this.objectModel.get(ServerPagesAction.REDIRECTOR_OBJECT);      this.actionResultMap = (Map)this.objectModel.get(ServerPagesAction.ACTION_RESULT_OBJECT);      if (this.actionRedirector == null) {        throw new ProcessingException("action logicsheet cannot be used in generators");      }/*The work of this action is to handle a request parameterpass it to the process, but reset it in the request*/  boolean stop=true;  String size=(String)request.getParameter("size");  if (size != null && !"".equals(size) && request.getAttribute("size") == null) {    this.actionResultMap.put("size", size);    stop=false;    // a marker to not redo    request.setAttribute("size", "done");  }	// action always true to have better debug information	try {			if (!stop) this.objectModel.put(ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.TRUE);		else this.objectModel.put(ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.FALSE);	} 	catch (Exception e) {this.objectModel.put(ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.FALSE);} ]]>	</xsp:logic>	</view></xsp:page>